{"version":3,"file":"sdk.js","sources":["../../src/sdk.ts"],"sourcesContent":["import { init as browserInit, SDK_VERSION } from '@sentry/browser';\nimport { hasTracingEnabled } from '@sentry/core';\nimport { arrayify, GLOBAL_OBJ } from '@sentry/utils';\n\nimport { DEFAULT_HOOKS } from './constants';\nimport { attachErrorHandler } from './errorhandler';\nimport { createTracingMixins } from './tracing';\nimport type { Options, TracingOptions, Vue } from './types';\n\nconst globalWithVue = GLOBAL_OBJ as typeof GLOBAL_OBJ & { Vue: Vue };\n\nconst DEFAULT_CONFIG: Options = {\n  Vue: globalWithVue.Vue,\n  attachProps: true,\n  logErrors: true,\n  hooks: DEFAULT_HOOKS,\n  timeout: 2000,\n  trackComponents: false,\n  _metadata: {\n    sdk: {\n      name: 'sentry.javascript.vue',\n      packages: [\n        {\n          name: 'npm:@sentry/vue',\n          version: SDK_VERSION,\n        },\n      ],\n      version: SDK_VERSION,\n    },\n  },\n};\n\n/**\n * Inits the Vue SDK\n */\nexport function init(\n  config: Partial<Omit<Options, 'tracingOptions'> & { tracingOptions: Partial<TracingOptions> }> = {},\n): void {\n  const options = {\n    ...DEFAULT_CONFIG,\n    ...config,\n  };\n\n  browserInit(options);\n\n  if (!options.Vue && !options.app) {\n    // eslint-disable-next-line no-console\n    console.warn(\n      `[@sentry/vue]: Misconfigured SDK. Vue specific errors will not be captured.\nUpdate your \\`Sentry.init\\` call with an appropriate config option:\n\\`app\\` (Application Instance - Vue 3) or \\`Vue\\` (Vue Constructor - Vue 2).`,\n    );\n    return;\n  }\n\n  if (options.app) {\n    const apps = arrayify(options.app);\n    apps.forEach(app => vueInit(app, options));\n  } else if (options.Vue) {\n    vueInit(options.Vue, options);\n  }\n}\n\nconst vueInit = (app: Vue, options: Options): void => {\n  // Check app is not mounted yet - should be mounted _after_ init()!\n  // This is _somewhat_ private, but in the case that this doesn't exist we simply ignore it\n  // See: https://github.com/vuejs/core/blob/eb2a83283caa9de0a45881d860a3cbd9d0bdd279/packages/runtime-core/src/component.ts#L394\n  const appWithInstance = app as Vue & {\n    _instance?: {\n      isMounted?: boolean;\n    };\n  };\n\n  const isMounted = appWithInstance._instance && appWithInstance._instance.isMounted;\n  if (isMounted === true) {\n    // eslint-disable-next-line no-console\n    console.warn(\n      '[@sentry/vue]: Misconfigured SDK. Vue app is already mounted. Make sure to call `app.mount()` after `Sentry.init()`.',\n    );\n  }\n\n  attachErrorHandler(app, options);\n\n  if (hasTracingEnabled(options)) {\n    app.mixin(\n      createTracingMixins({\n        ...options,\n        ...options.tracingOptions,\n      }),\n    );\n  }\n};\n"],"names":["GLOBAL_OBJ","DEFAULT_HOOKS","SDK_VERSION","browserInit","arrayify","attachErrorHandler","hasTracingEnabled","createTracingMixins"],"mappings":";;;;;;;;;AASA,MAAA,aAAA,GAAAA,gBAAA,EAAA;AACA;AACA,MAAA,cAAA,GAAA;AACA,EAAA,GAAA,EAAA,aAAA,CAAA,GAAA;AACA,EAAA,WAAA,EAAA,IAAA;AACA,EAAA,SAAA,EAAA,IAAA;AACA,EAAA,KAAA,EAAAC,uBAAA;AACA,EAAA,OAAA,EAAA,IAAA;AACA,EAAA,eAAA,EAAA,KAAA;AACA,EAAA,SAAA,EAAA;AACA,IAAA,GAAA,EAAA;AACA,MAAA,IAAA,EAAA,uBAAA;AACA,MAAA,QAAA,EAAA;AACA,QAAA;AACA,UAAA,IAAA,EAAA,iBAAA;AACA,UAAA,OAAA,EAAAC,mBAAA;AACA,SAAA;AACA,OAAA;AACA,MAAA,OAAA,EAAAA,mBAAA;AACA,KAAA;AACA,GAAA;AACA,CAAA,CAAA;AACA;AACA;AACA;AACA;AACA,SAAA,IAAA;AACA,EAAA,MAAA,GAAA,EAAA;AACA,EAAA;AACA,EAAA,MAAA,OAAA,GAAA;AACA,IAAA,GAAA,cAAA;AACA,IAAA,GAAA,MAAA;AACA,GAAA,CAAA;AACA;AACA,EAAAC,YAAA,CAAA,OAAA,CAAA,CAAA;AACA;AACA,EAAA,IAAA,CAAA,OAAA,CAAA,GAAA,IAAA,CAAA,OAAA,CAAA,GAAA,EAAA;AACA;AACA,IAAA,OAAA,CAAA,IAAA;AACA,MAAA,CAAA;AACA;AACA,4EAAA,CAAA;AACA,KAAA,CAAA;AACA,IAAA,OAAA;AACA,GAAA;AACA;AACA,EAAA,IAAA,OAAA,CAAA,GAAA,EAAA;AACA,IAAA,MAAA,IAAA,GAAAC,cAAA,CAAA,OAAA,CAAA,GAAA,CAAA,CAAA;AACA,IAAA,IAAA,CAAA,OAAA,CAAA,GAAA,IAAA,OAAA,CAAA,GAAA,EAAA,OAAA,CAAA,CAAA,CAAA;AACA,GAAA,MAAA,IAAA,OAAA,CAAA,GAAA,EAAA;AACA,IAAA,OAAA,CAAA,OAAA,CAAA,GAAA,EAAA,OAAA,CAAA,CAAA;AACA,GAAA;AACA,CAAA;AACA;AACA,MAAA,OAAA,GAAA,CAAA,GAAA,EAAA,OAAA,KAAA;AACA;AACA;AACA;AACA,EAAA,MAAA,eAAA,GAAA,GAAA;;AAIA,CAAA;AACA;AACA,EAAA,MAAA,SAAA,GAAA,eAAA,CAAA,SAAA,IAAA,eAAA,CAAA,SAAA,CAAA,SAAA,CAAA;AACA,EAAA,IAAA,SAAA,KAAA,IAAA,EAAA;AACA;AACA,IAAA,OAAA,CAAA,IAAA;AACA,MAAA,sHAAA;AACA,KAAA,CAAA;AACA,GAAA;AACA;AACA,EAAAC,+BAAA,CAAA,GAAA,EAAA,OAAA,CAAA,CAAA;AACA;AACA,EAAA,IAAAC,sBAAA,CAAA,OAAA,CAAA,EAAA;AACA,IAAA,GAAA,CAAA,KAAA;AACA,MAAAC,2BAAA,CAAA;AACA,QAAA,GAAA,OAAA;AACA,QAAA,GAAA,OAAA,CAAA,cAAA;AACA,OAAA,CAAA;AACA,KAAA,CAAA;AACA,GAAA;AACA,CAAA;;;;"}